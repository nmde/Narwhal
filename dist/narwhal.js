!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require("http"),require("https"),require("url")):"function"==typeof define&&define.amd?define(["http","https","url"],n):t.Narwhal=n(t.http,t.https,t.url)}(this,function(t,n,e){"use strict";function o(t){return new Promise(function(n,e){var o=t.statusCode;if(o<200||o>=400)e(new Error("Error "+o));else{t.setEncoding("utf-8");var r="";t.on("data",function(t){r+=t}),t.on("end",function(){n(r)})}})}function r(r){return new Promise(function(i,u){var c=e.parse(r);switch(c.protocol){case"https:":console.log("Using https"),n.get(r,function(t){o(t).then(function(t){i(t)}).catch(function(t){u(t)})});break;case"http:":console.log("Using http"),t.get(r,function(t){o(t).then(function(t){i(t)}).catch(function(t){u(t)})});break;default:u(new Error("Unknown protocol: "+c.protocol))}})}t="default"in t?t.default:t,n="default"in n?n.default:n,e="default"in e?e.default:e;var i=function(t){"string"==typeof t&&this.open(t)};return i.prototype.open=function(t){var n=this;return new Promise(function(e,o){r(t).then(function(o){n.location=t,e(o)}).catch(function(t){o(t)})})},{Browser:i,Window:function(){}}});